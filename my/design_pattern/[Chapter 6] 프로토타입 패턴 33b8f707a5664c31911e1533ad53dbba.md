# [Chapter 6] 프로토타입 패턴

프로토타입 패턴은 new 키워드를 사용하지 않고 객체를 복제해 생성하는 패턴이다.

## 생성

- 객체는 선언한 클래스의 인스턴스화를 통해 생성되고 메모리에 적재된다.

생성되는 객체가 많거나 크기가 클수록 시스템이 처리할 부하가 늘어난다. 빌더 패턴과 같이 복잡한 구조인 객체는 더 많은 자원을 사용한다.

객체는 상탯값을 가진 데이터가 존재한다.

전달받은 매개변수를 보존하기 위해 내부의 프로퍼티에 저장한다.

new 키워드는 객체를 생성할 때마다 메모리의 자원을 소모한다. 프로그램에서 다수의 동일한 객체를 만드는 이유는 서로 다른 상탯값을 가진 객체가 필요하기 때문이다.

> 객체의 상탯값은 생성자를 통해 객체 생성 시 또는 프로그램 실행 중에 상탯값을 변경하여 설정할 수 있다.
> 

## 복사

### 복사의 종류

- 변수에 담긴 객체는 또 다른 변수로 복제할 수 있다.
- 변수의 복제는 기존 변수를 공유하는 얕은 복사와 새로운 자원을 할당받는 깊은 복사로 크게 구분된다.

### 객체를 공유하는 얕은 복사

얕은 복사는 객체를 공유하는 방식으로 복사한다.

얕은 복사를 할 때는 대입 연산자 (=)를 사용하는데 이 연산자는 메모리에 담긴 실제 변수를 복사하지 않는다. 단지 포인터일 뿐이다.

### 깊은 복사

clone 키워드를 이용하여 새로운 메모리 영역을 할당하여 실제 객체를 복제한다. 깊은 복사를 사용하면 메모리의 자원이 소모된다.

> 객체 생성은 new 키워드를 사용하고, 객체 복사는 clone 키워드를 사용한다.
> 

## 프로토타입 패턴

프로토타입 패턴은 신규 객체를 생성하지 않고 유사한 기존 객체를 복제한다. 기존 객체를 복제하면 신규 객체를 생성하는 것보다 자원이 절약된다.

### 생성자 동작

인스턴스화는 객체 생성 시 클래스에 선언된 생성자를 자동 호출한다.

new 키워드를 이용해서 객체를 생성하면 생성 시 construct() 생성자 메서드가 같이 호출된다.

앞에서 생성한 객체를 clone 키워드로 복제한다.

객체를 복제할 때는 생성자가 호출되지 않는다. 이처럼 클래스의 객체를 직접 생성할 수도 있지만, 기존의 객체를 복제하여 생성할 수도 있다.

### 복제 처리

- new 키워드는 새로운 객체를 생성할 때 시스템의 자원을 소모한다.
- 변수에 저장된 객체는 다른 변수로 복제할 수 있다.
- 매번 인스턴스화 과정을 통해 새로운 객체를 생성하지 않고 변수를 복제하여 객체를 생성할 수도 있다.
- 객체를 복제할 경우 인스턴스화 과정이 생략되기 때문이다. 객체를 복제하면 생성 로직에 소모되는 처리 시간과 자원을 절약할 수 있다.

### 자원 절약

프로토타입 패턴은 복잡한 과정으로 생성된 객체를 복제할 때 더 유용하다.

새로운 객체의 상태값을 설정하기 위해 메서드를 호출하거나 또 다른 객체를 실행해야 하는데

프로토타입 패턴을 적용하면 매번 객체를 만드는 과정과 초기화 작업을 반복하지 않아도 된다. 객체 생성 시 많은 자원을 소모하는 경우, 새로운 객체를 생성하는 것보다 기존 객체를 복제하는 것이 더 효율적이다. 객체가 복제될 때는 생성자 로직이 동작하지 않는다.

공통된 상탯값을 유지한 채 필요한 값만 변경해서 사용하면 된다.

## 특징

1. 생성자 동작 처리 배제
2. 적은 자원 소모로 객체 대량 생산
3. 유사 객체 사용시 유용
4. 기존 객체 생성 방법을 몰라도 생성 가능

## 관련 패턴

### 플라이웨이트 패턴

객체를 공유하거나 동일한 상태의 객체를 별도로 생성할 때 프로토 타입 패턴을 같이 사용할 수 있다.

## 메멘토 패턴

메멘토 패턴은 객체를 저장하는 역할을 수행한다. 객체 저장 시 프로토타입 패턴을 같이 응용할 수 있다.

## 복합체 패턴, 장식자 패턴

객체가 동적으로 생성될 때 프로토타입 패턴을 사용할 수 있다.

### 명령 패턴

명령을 복제할 때 프로토타입을 사용할 수 있다.

## 정리

인터프리터 언어는 컴파일 언어와 다르게 실행 단계에서 객체를 생성하고 메모리 자원에 할당한다. 추상 팩토리 패턴은 프로토타입 패턴의 집합을 저장하는 상태에서, 필요한 경우 기존 객체를 복제해 객체를 변환할 수 있다.